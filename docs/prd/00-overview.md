# 缠论实验室 PRD - 产品需求文档

## 文档信息

- **产品名称**: 缠论实验室 (Chan Theory Lab)
- **版本**: v1.0
- **创建日期**: 2026-01-13
- **文档类型**: 产品需求文档 (PRD)
- **开发路径**: 路径B - 混合迭代路径

## 文档结构

本 PRD 文档分为以下几个部分：

1. **00-overview.md** - 产品概述（本文档）
2. **01-phase1-data-layer.md** - Phase 1: 数据层 + 基础原型
3. **02-phase2-chan-calculation.md** - Phase 2: 完善缠论计算
4. **03-phase3-strategy-backtest.md** - Phase 3: 策略和回测
5. **04-phase4-auto-trading.md** - Phase 4: 自动交易
6. **05-technical-architecture.md** - 技术架构设计
7. **06-data-models.md** - 数据模型设计
8. **07-acceptance-criteria.md** - 验收标准和测试计划

---

## 产品概述

### 产品定位

缠论实验室是一个基于缠论（缠中说禅技术分析理论）的**量化交易分析平台**，为交易员提供：

- 实时的缠论结构分析（分型、笔、线段、中枢）
- 多级别联立分析
- 自动化的买卖点识别
- 策略回测和优化
- 信号推送和自动交易

### 目标用户

1. **专业交易员** - 使用缠论进行交易决策
2. **量化交易者** - 开发和验证缠论策略
3. **缠论学习者** - 学习和实践缠论理论

### 核心价值

1. **准确性** - 严格按照缠论定义实现算法
2. **实时性** - 毫秒级的计算和信号推送
3. **可靠性** - 完整的数据质量保障机制
4. **可扩展性** - 支持多标的、多周期、多策略

---

## 开发路径：路径B（混合迭代）

### 为什么选择路径B？

**路径B 的特点：**
- 先把数据层做扎实（避免后续返工）
- 但在数据层开发时就能看到基础效果（保持动力）
- 每个阶段都有明确的交付物
- 适合 1-3 人的小团队

**与路径A（横向分层）的对比：**

| 维度 | 路径A（横向分层） | 路径B（混合迭代） |
|------|------------------|------------------|
| 反馈周期 | 2-3个月 | 3-4周 |
| 数据质量 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 开发动力 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 需求调整灵活性 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 适合团队规模 | 3人以上 | 1-3人 |

---

## 开发时间线

```
Phase 1: 数据层 + 基础原型 (3-4周)
  Week 1-2: 数据源管理 + 数据同步
  Week 3-4: 基础缠论计算 + 前端集成
  ✅ 交付物: 可以看到实时的分型和笔

Phase 2: 完善缠论计算 (3-4周)
  Week 5-6: 线段识别 + 中枢识别
  Week 7-8: 买卖点判定 + 测试优化
  ✅ 交付物: 完整准确的缠论分析

Phase 3: 策略和回测 (3-4周)
  Week 9-10: 策略配置系统 + 回测引擎
  Week 11-12: 多级别联立 + 信号推送
  ✅ 交付物: 可以验证策略有效性

Phase 4: 自动交易 (4-6周)
  Week 13-14: 风控系统
  Week 15-16: 订单管理 + 自动交易
  Week 17-18: 压力测试 + 优化
  ✅ 交付物: 可以实盘运行的系统

总计: 13-18周
```

---

## 技术栈

### 前端
- **框架**: Vue 3 + Composition API
- **UI**: Tailwind CSS + Ant Design Vue
- **图表**: ECharts
- **状态管理**: Pinia
- **构建工具**: Vite
- **语言**: TypeScript（重构）

### 后端
- **框架**: Spring Boot 4.0.1
- **语言**: Java 21
- **数据库**: PostgreSQL（主数据库）+ TimescaleDB（时序数据）
- **缓存**: Redis
- **消息队列**: Kafka（可选，用于高并发场景）
- **WebSocket**: Spring WebSocket

### 基础设施
- **容器化**: Docker + Docker Compose
- **监控**: Prometheus + Grafana
- **日志**: ELK Stack（可选）
- **CI/CD**: GitHub Actions

---

## 核心功能模块

### 1. 数据层
- 多交易所适配（Binance、OKX、Bybit）
- 实时数据同步（WebSocket）
- 历史数据回补
- 数据完整性检测和自动修复
- 延迟监控和告警

### 2. 计算层
- K线包含关系处理
- 分型识别
- 笔的构建
- 线段划分
- 中枢识别
- 买卖点判定（含背驰分析）
- 增量计算优化

### 3. 策略层
- 策略配置系统
- 多级别联立分析
- 回测引擎
- 信号生成和推送
- 策略性能统计

### 4. 交易层
- 风控系统
- 订单管理
- 自动交易执行
- 持仓管理
- 交易日志和审计

### 5. 前端展示
- 市场扫描（多标的监控）
- 图表分析（缠论可视化）
- 策略管理
- 回测报告
- 实时持仓和盈亏

---

## 关键成功因素

### 1. 数据质量（最重要）
- ✅ 完整性：无缺失数据
- ✅ 准确性：数据格式正确
- ✅ 实时性：延迟 < 100ms
- ✅ 可靠性：自动检测和修复

### 2. 算法准确性
- ✅ 严格按照缠论定义实现
- ✅ 完整的单元测试覆盖
- ✅ 使用真实历史数据验证
- ✅ 找缠论专家审核

### 3. 性能优化
- ✅ 增量计算（< 10ms/次）
- ✅ 并行计算（多标的）
- ✅ 缓存策略（Redis）
- ✅ 数据库优化（索引、分区）

### 4. 系统可靠性
- ✅ 异常处理（网络断开、API限流）
- ✅ 监控告警（延迟、错误率）
- ✅ 日志审计（所有关键操作）
- ✅ 灾难恢复（数据备份）

### 5. 用户体验
- ✅ 响应速度快（< 1s）
- ✅ 界面清晰直观
- ✅ 实时更新反馈
- ✅ 移动端支持

---

## 风险和挑战

### 技术风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 缠论算法实现错误 | 高 | 中 | 完整测试 + 专家审核 |
| 数据源不稳定 | 高 | 中 | 多数据源冗余 + 自动切换 |
| 性能瓶颈 | 中 | 中 | 增量计算 + 缓存优化 |
| 交易所API变更 | 中 | 低 | 适配器模式 + 版本管理 |

### 业务风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 策略失效 | 高 | 中 | 持续回测 + 参数优化 |
| 市场环境变化 | 高 | 高 | 多策略组合 + 风控 |
| 自动交易风险 | 高 | 中 | 严格风控 + 模拟盘测试 |
| 用户资金安全 | 高 | 低 | API Key加密 + 权限控制 |

---

## 项目里程碑

### Milestone 1: 数据层完成（Week 4）
- ✅ 可以实时获取多个交易所的K线数据
- ✅ 历史数据回补完成
- ✅ 数据完整性检测正常运行
- ✅ 可以看到基础的分型和笔

### Milestone 2: 缠论计算完成（Week 8）
- ✅ 完整的缠论算法实现
- ✅ 单元测试覆盖率 > 80%
- ✅ 性能达标（< 10ms/次）
- ✅ 可以准确识别买卖点

### Milestone 3: 策略系统完成（Week 12）
- ✅ 策略配置系统可用
- ✅ 回测引擎正常工作
- ✅ 可以验证策略有效性
- ✅ 信号推送稳定

### Milestone 4: 自动交易完成（Week 18）
- ✅ 风控系统完善
- ✅ 自动交易稳定运行
- ✅ 通过压力测试
- ✅ 可以实盘运行

---

## 下一步

请阅读各个 Phase 的详细需求文档：

1. **Phase 1**: [01-phase1-data-layer.md](./01-phase1-data-layer.md)
2. **Phase 2**: [02-phase2-chan-calculation.md](./02-phase2-chan-calculation.md)
3. **Phase 3**: [03-phase3-strategy-backtest.md](./03-phase3-strategy-backtest.md)
4. **Phase 4**: [04-phase4-auto-trading.md](./04-phase4-auto-trading.md)

技术文档：
- [05-technical-architecture.md](./05-technical-architecture.md)
- [06-data-models.md](./06-data-models.md)
- [07-acceptance-criteria.md](./07-acceptance-criteria.md)

---

## 联系方式

如有问题或建议，请联系项目负责人。
